# Production Environment Configuration
# Copy this file to .env.production and fill in actual values
# NEVER commit .env.production to version control

# Environment
NODE_ENV=production

# Server
PORT=3000

# Database
# Use strong credentials from your database provider
DATABASE_URL=postgresql://dbuser:STRONG_PASSWORD_HERE@db-host:5432/production_db?schema=public

# Observability
LOG_LEVEL=info
METRICS_ENABLED=false
# To enable metrics in production, pick ONE guard mode below and uncomment it.
# Option A: Shared secret (recommended when scraping over private network)
# METRICS_GUARD=secret
# METRICS_GUARD_SECRET=GENERATE_STRONG_SECRET_HERE
# Option B: CIDR allowlist (restricts by IP ranges)
# METRICS_GUARD=cidr
# METRICS_GUARD_ALLOWLIST=10.0.0.0/8,172.16.0.0/12

# JWT
# CRITICAL: Generate strong random secrets (min 32 chars)
# Example: openssl rand -base64 32
JWT_ACCESS_SECRET=GENERATE_STRONG_SECRET_HERE
JWT_REFRESH_SECRET=GENERATE_STRONG_SECRET_HERE
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d

# Auth
AUTH_EMAIL_VERIFICATION_REQUIRED=true
AUTH_EMAIL_VERIFICATION_TTL_MINUTES=60
AUTH_PASSWORD_RESET_TTL_MINUTES=30
AUTH_LOGIN_MAX_ATTEMPTS=5
AUTH_LOGIN_LOCKOUT_MINUTES=15
AUTH_LOGIN_ATTEMPT_WINDOW_MINUTES=15

# Sessions
SESSION_CLEANUP_INTERVAL_MINUTES=60

# CORS
# List your production frontend URLs
CORS_ORIGINS=https://app.yourdomain.com,https://admin.yourdomain.com
# Enable only if your deployment needs credentialed cross-origin requests
CORS_ALLOW_CREDENTIALS=false
# Tune preflight cache lifetime (seconds)
CORS_MAX_AGE_SECONDS=600

# Rate limiting
RATE_LIMIT_RPM=600
RATE_LIMIT_RPM_AUTH=120
RATE_LIMIT_WINDOW_SEC=900
# Required in production - use Redis for distributed rate limiting
RATE_LIMIT_REDIS_URL=redis://redis-host:6379

# Response compression
RESPONSE_COMPRESSION_ENABLED=true
RESPONSE_COMPRESSION_MIN_BYTES=1024

# Request parsing + server timeouts
REQUEST_BODY_LIMIT=100kb
HTTP_SERVER_REQUEST_TIMEOUT_MS=30000
HTTP_SERVER_HEADERS_TIMEOUT_MS=60000
HTTP_SERVER_KEEPALIVE_TIMEOUT_MS=5000
